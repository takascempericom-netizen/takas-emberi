<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>İlan Ver • Takas Çemberi</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;margin:0;background:#f8fafc;color:#0b0b0b}
    .wrap{max-width:720px;margin:32px auto;padding:16px}
    h1{font-size:22px;margin:0 0 16px}
    form{background:#fff;border:1px solid #e5e7eb;border-radius:14px;padding:16px;box-shadow:0 2px 6px rgba(0,0,0,.04)}
    label{display:block;font-size:14px;margin:10px 0 6px;color:#374151}
    input[type="text"], textarea, input[type="file"]{
      width:100%;padding:10px 12px;border:1px solid #e5e7eb;border-radius:10px;font-size:15px;outline:none
    }
    textarea{min-height:120px;resize:vertical}
    .row{display:flex;gap:12px;flex-wrap:wrap}
    .row>div{flex:1 1 260px}
    .actions{margin-top:14px;display:flex;gap:10px;align-items:center}
    button{appearance:none;border:0;background:#0ea5e9;color:#fff;padding:10px 14px;border-radius:10px;font-weight:600;cursor:pointer}
    button:disabled{opacity:.55;cursor:not-allowed}
    .note{font-size:13px;color:#6b7280;margin-top:6px}
    .alert{padding:10px 12px;border-radius:10px;background:#ecfeff;border:1px solid #cffafe;color:#155e75;margin-bottom:12px;display:none}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>İlan Ver</h1>

    <div id="authWarn" class="alert">Devam etmek için giriş yapmalısınız.</div>

    <form id="listingForm">
      <div class="row">
        <div>
          <label for="title">Başlık</label>
          <input type="text" id="title" placeholder="Örn: Az kullanılmış masaüstü bilgisayar" required>
        </div>
      </div>

      <label for="desc">Açıklama</label>
      <textarea id="desc" placeholder="Ürün durumu, takas tercihi, teslimat vb."></textarea>

      <label for="images">Fotoğraflar</label>
      <input type="file" id="images" accept="image/*" multiple>
      <div class="note">En fazla birkaç görsel ekleyin. Önce görseller yüklenir, sonra ilanınız <strong>Onay Bekleyen</strong> durumunda kaydedilir.</div>

      <div class="actions">
        <button id="btnSubmit" type="submit">İlanı Gönder</button>
        <div class="note">Admin onayından sonra yayında görünecek.</div>
      </div>
    </form>
  </div>

  <!-- Firebase App config -->
  <script type="module" src="/js/firebase-config.js"></script>

  <!-- İlan oluşturma akışı (Storage upload + Firestore status: pending) -->
  <script type="module" src="/js/listing-new.js"></script>

  <!-- Basit auth uyarısı -->
  <script type="module">
    import { app } from "/js/firebase-config.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.24.0/firebase-auth.js";
    const auth = getAuth(app);
    const warn = document.getElementById('authWarn');
    const btn  = document.getElementById('btnSubmit');

    onAuthStateChanged(auth, (user) => {
      const loggedIn = !!user;
      warn.style.display = loggedIn ? 'none' : 'block';
      btn.disabled = !loggedIn;
    });
  </script>
</body>
</html>
