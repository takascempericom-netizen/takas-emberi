<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Takas Ã‡emberi â€¢ GiriÅŸ / KayÄ±t</title>
  <link rel="icon" href="/assets/img/seffaf.png">
  <meta name="color-scheme" content="light dark" />
  
  <style>
    :root{
      --bg:#ffffff; --ink:#0f172a; --muted:#64748b; --line:#e5e7eb;
      --brandA:#6a5cff; --brandB:#00d4ff; --focus:#0ea5e9;
      --c1:#6d28d9; --c2:#2563eb; --c3:#0891b2; --c4:#db2777;
      --paper:#ffffff; --paper2:#f8fafc; --btn:#111827; --btnInk:#fff;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:var(--bg); color:var(--ink);
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      overflow-x:hidden;
    }
    img,svg{max-width:100%; height:auto; display:block}

    /* Top bar */
    .topbar{
      position:sticky; top:0; z-index:100;
      display:flex; align-items:center; gap:12px; flex-wrap:wrap;
      min-height:64px;
      background:linear-gradient(90deg,var(--brandA),var(--brandB));
      background-size:200% 200%; animation:barShift 8s ease-in-out infinite;
      padding:8px 12px; box-shadow:0 2px 14px rgba(10,20,60,.18);
      border-bottom:1px solid rgba(0,0,0,.06)
    }
    @keyframes barShift{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
    .brand{display:flex; align-items:center; gap:10px; text-decoration:none; color:#fff}
    .brand img{height:clamp(40px,9vw,56px); filter:drop-shadow(0 2px 6px rgba(0,0,0,.25))}
    .grow{flex:1 1 auto; min-width:20px}
    .btn{border:0;border-radius:14px;padding:10px 14px;font-weight:700;cursor:pointer;white-space:nowrap}
    .btn.primary{background:var(--btn);color:var(--btnInk)}
    .btn.ghost{background:rgba(255,255,255,.14);color:#fff;border:1px solid rgba(255,255,255,.28)}
    .btn.light{background:#fff; color:#111827; border:1px solid #e5e7eb}
    .btn:focus{outline:2px solid var(--focus);outline-offset:2px}
    @media (max-width:380px){ .btn{padding:8px 10px;font-size:13px} }

    /* Hero */
    .hero{max-width:1100px;margin:24px auto;padding:16px}
    .panel{background:var(--paper);border:1px solid var(--line);border-radius:20px;padding:24px;box-shadow:0 10px 40px rgba(5,10,30,.12)}
    .hero-panel{
      display:grid;place-items:center;text-align:center;padding:32px 24px;
      background:linear-gradient(135deg,var(--c1),var(--c2),var(--c3),var(--c4));
      background-size:800% 800%;animation:panelBG 16s ease infinite;border-color:transparent;color:#fff
    }
    @keyframes panelBG{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
    .hero-logo{width:clamp(120px,28vw,220px); margin:0 auto 12px; filter:drop-shadow(0 2px 6px rgba(0,0,0,.25))}
    .title{font-size:clamp(32px,6vw,56px); font-weight:900; margin:0 0 12px; text-shadow:0 1px 14px rgba(0,0,0,.25)}
    .subtitle{font-size:clamp(16px,3.2vw,20px); margin:0 0 6px; opacity:.98}
    .cta-wrap{display:flex; gap:10px; flex-wrap:wrap; justify-content:center; margin-top:12px}

    /* Slogan panel */
    .slogan-panel{margin:20px auto; max-width:900px; padding:20px; border-radius:20px; text-align:center; color:#0f172a; background:#ffffff; border:1px solid var(--line); box-shadow:0 4px 30px rgba(0,0,0,.06)}
    .slogan-rotator{font-size:clamp(16px,3.5vw,22px); font-weight:800; min-height:2.2em; transition:opacity .35s ease}

    /* Ä°lan grid */
    .ads-wrap{max-width:1100px;margin:12px auto;padding:0 16px}
    .ads-grid{display:grid;gap:12px;grid-template-columns:repeat(2,1fr)}
    @media (min-width:900px){.ads-grid{grid-template-columns:repeat(4,1fr)}}
    .ad-card{border:1px solid var(--line); border-radius:16px; overflow:hidden; background:#fff; color:#111827; text-decoration:none; box-shadow:0 6px 18px rgba(0,0,0,.06); transition:transform .15s ease; cursor:pointer}
    .ad-card:hover{transform:translateY(-2px)}
    .ad-media{position:relative;width:100%;background:#f1f5f9;border-bottom:1px solid var(--line)}
    .ad-media::before{content:"";display:block;padding-top:100%}
    .ad-media img{position:absolute; inset:0; width:100%; height:100%; object-fit:cover; object-position:center; display:block; image-orientation:from-image}
    .ad-body{padding:10px}
    .ad-title{margin:0 0 4px; font-size:14px; font-weight:800; line-height:1.25; color:#0f172a; display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical; overflow:hidden; min-height: calc(1.25em * 2)}
    .ad-meta{display:flex;gap:6px;justify-content:space-between;color:#64748b;font-size:12px}

    /* Dialoglar */
    dialog{border:0;border-radius:16px;padding:0;max-width:95vw;background:var(--paper);color:var(--ink);border:1px solid var(--line); z-index:200}
    dialog::backdrop{background:rgba(0,0,0,.45)}
    .modal{padding:16px; width:min(560px,95vw); position:relative}
    .in{width:100%;padding:12px 44px 12px 12px;border-radius:12px;border:1px solid var(--line);margin-bottom:10px;font-size:16px;background:var(--paper2);color:var(--ink)}
    .in:focus{outline:2px solid var(--focus);border-color:transparent}
    .x{position:absolute;top:10px;right:12px;background:transparent;border:0;font-size:22px;cursor:pointer;color:#64748b}
    .field{position:relative}
    .toggle{position:absolute;right:10px;top:50%;transform:translateY(-50%);border:0;background:transparent;color:#64748b;cursor:pointer;font-size:13px}
    .row{display:flex;gap:10px; flex-wrap:wrap}
    .row > *{flex:1 1 220px; min-width:0}
    .legal-ack{display:flex;gap:10px;align-items:flex-start;background:#f8fafc;border:1px solid var(--line); padding:10px;border-radius:12px;margin-top:6px}
    .legal-ack label{line-height:1.4}
    .legal-ack a{color:#2563eb;text-decoration:none}
    .legal-ack a:hover{text-decoration:underline}

    /* Footer */
    footer{border-top:1px solid var(--line); margin-top:30px}
    .foot-wrap{max-width:1100px; margin:0 auto; padding:12px 16px; color:#64748b; display:flex; gap:12px; align-items:center; flex-wrap:wrap}
    .foot-logo{height:clamp(20px,4vw,28px)}
    .foot-links{display:flex; gap:12px; flex-wrap:wrap}
    .foot-links a{color:#64748b; text-decoration:none}
    .foot-links a:hover{text-decoration:underline}
      /* Kategori grid & kartlarÄ± */
    .grid{display:grid;gap:12px;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));margin-top:12px}
    .card{border-radius:18px;padding:16px;min-height:120px;display:flex;flex-direction:column;gap:6px;align-items:center;justify-content:center;color:#fff;animation:cardColors 20s infinite alternate ease-in-out;background:var(--c1);transition:transform .18s,border-color .2s;border:1px solid rgba(0,0,0,.06)}
    .card:hover{transform:translateY(-6px)}
    @keyframes cardColors{0%{background:var(--c1)}25%{background:var(--c2)}50%{background:var(--c3)}75%{background:var(--c4)}100%{background:var(--c1)}}
    .emoji{font-size:26px}
    .features{display:grid;gap:12px;margin-top:16px;grid-template-columns:repeat(auto-fit,minmax(210px,1fr))}
    .feature{padding:12px;border-radius:14px;color:#0f172a;text-align:center;background:#fff;border:1px solid var(--line)}
  </style>
</head>
 <body>
  <!-- Ãœst Ã§ubuk -->
  <header class="topbar">
    <a class="brand" href="/"><img src="/assets/img/seffaf.png" alt="Takas Ã‡emberi"/></a>
    <div class="grow"></div>

    <!-- Dil seÃ§imi (i18n) -->
    <select id="langSelect" style="border-radius:8px;padding:6px;font-weight:600">
      <option value="tr">TR</option>
      <option value="en">EN</option>
      <option value="ar">AR</option>
    </select>

    <button class="btn ghost" id="btnLoginOpen" data-i18n="dlg.login.title">GiriÅŸ Yap</button>
    <button class="btn primary" id="btnSignupOpen" data-i18n="dlg.signup.title">Kaydol</button>
  </header>

  <!-- Ä°Ã§erik -->
  <main class="hero">
    <section class="panel hero-panel" aria-labelledby="welcome-title">
      <img class="hero-logo" src="/assets/img/seffaf.png" alt="Takas Ã‡emberi logo">
      <h1 id="welcome-title" class="title" data-i18n="brand.slogan">Takas Ã‡emberiâ€™ne HoÅŸ Geldiniz</h1>
      <p class="subtitle" data-i18n="brand.sub">Toplulukla takas et, eÅŸyana yeni bir hayat ver.</p>
      <div class="cta-wrap">
        <button class="btn light" id="btnBrowse" data-i18n="cta.browse">Ä°lanlara GÃ¶z At</button>
        <button class="btn primary" id="btnPrimaryPost" data-i18n="cta.post">Hemen Ãœcretsiz Ä°lan Ver</button>
      </div>
    </section>

    <section class="slogan-panel" aria-hidden="false">
      <div class="slogan-rotator" id="slogan" aria-live="polite"></div>
    </section>
  </main>

  <!-- Ä°LANLAR (MISAFIR GORUNUM) -->
  <section class="ads-wrap" aria-labelledby="ads-title">
    <div class="panel" style="padding:16px">
      <h2 id="ads-title" style="margin:0 0 12px" data-i18n="sec.newlistings">Yeni Ä°lanlar</h2>
      <div class="ads-grid" id="adsGrid" role="list"></div>
      <div id="adsHint" style="margin-top:10px;color:#64748b;font-size:13px" data-i18n="hint.listings.click">Ä°lan kartÄ±na tÄ±kladÄ±ÄŸÄ±nÄ±zda kayÄ±t penceresi aÃ§Ä±lÄ±r.</div>
    </div>
  </section>

  <!-- KATEGORÄ°LER + Ã–ZELLÄ°KLER -->
  <section class="ads-wrap" aria-labelledby="cats-title">
    <div class="panel" style="padding:16px">
      <h2 id="cats-title" style="margin:0 0 12px" data-i18n="sec.categories">Kategoriler</h2>
      <div class="grid" role="list">
        <div class="card" role="listitem"><div class="emoji">ğŸ </div><h3 data-i18n="cat.home">Ev & Hobi</h3><p data-i18n="cat.home.desc">Ev eÅŸyalarÄ±, hobi Ã¼rÃ¼nleri</p></div>
        <div class="card" role="listitem"><div class="emoji">ğŸ¡</div><h3 data-i18n="cat.real">TaÅŸÄ±nmaz</h3><p data-i18n="cat.real.desc">Ev, arsa, tarla</p></div>
        <div class="card" role="listitem"><div class="emoji">ğŸš—</div><h3 data-i18n="cat.auto">Motorlu TaÅŸÄ±tlar</h3><p data-i18n="cat.auto.desc">Araba, motosiklet, yedek parÃ§a</p></div>
        <div class="card" role="listitem"><div class="emoji">ğŸ§¸</div><h3 data-i18n="cat.toy">Oyuncak</h3><p data-i18n="cat.toy.desc">Her yaÅŸa uygun oyuncaklar</p></div>
        <div class="card" role="listitem"><div class="emoji">ğŸ‘—</div><h3 data-i18n="cat.fashion">Giyim</h3><p data-i18n="cat.fashion.desc">KadÄ±n, erkek, Ã§ocuk</p></div>
        <div class="card" role="listitem"><div class="emoji">âš¡</div><h3 data-i18n="cat.appliance">Beyaz EÅŸya</h3><p data-i18n="cat.appliance.desc">Ev aletleri, mutfak</p></div>
        <div class="card" role="listitem"><div class="emoji">ğŸ’»</div><h3 data-i18n="cat.tech">Teknoloji</h3><p data-i18n="cat.tech.desc">Bilgisayar, telefon</p></div>
        <div class="card" role="listitem"><div class="emoji">ğŸ›‹ï¸</div><h3 data-i18n="cat.furniture">Mobilya</h3><p data-i18n="cat.furniture.desc">Koltuk, masa, dolap</p></div>
      </div>

      <div class="features" style="margin-top:16px">
        <div class="feature" data-i18n="feat.safe">âœ… GÃ¼venli Takas<br/>SSL ve KVKK gÃ¼vencesiyle gÃ¼venli iÅŸlemler.</div>
        <div class="feature" data-i18n="feat.easy">ğŸ“± Kolay KullanÄ±m<br/>Mobil uyumlu arayÃ¼z ile her yerde ilan ver.</div>
        <div class="feature" data-i18n="feat.support">ğŸ’¬ CanlÄ± Destek<br/>7/24 destek ekibi seninle.</div>
      </div>
    </div>
  </section>

  <!-- Alt bilgi -->
  <footer>
    <div class="foot-wrap">
      <img class="foot-logo" src="/assets/img/legallogo.png" alt="Takas Ã‡emberi yasal logo">
      <nav class="foot-links" aria-label="Yasal baÄŸlantÄ±lar">
        <a href="/legal/hakkimizda.html" target="_blank">HakkÄ±mÄ±zda</a>
        <a href="/legal/gizlilik.html" target="_blank">Gizlilik</a>
        <a href="/legal/teslimat-iade.html" target="_blank">Teslimat &amp; Ä°ade</a>
        <a href="/legal/mesafeli-satis-sozlesmesi.html" target="_blank">Mesafeli SatÄ±ÅŸ</a>
        <a href="/legal/kullanim-sartlari.html" target="_blank">KullanÄ±m ÅartlarÄ±</a>
        <a href="/legal/kvkk.html" target="_blank">KVKK</a>
        <a href="/legal/iletisim.html" target="_blank">Ä°letiÅŸim &amp; Ticari</a>
      </nav>
      <div class="grow"></div>
      <small>Â© 2025 Takas Ã‡emberi â€¢ takascemberi.com</small>
    </div>
  </footer>

  <!-- MODALLAR -->
  <dialog id="dlgLogin" aria-modal="true" role="dialog">
    <form method="dialog" class="modal">
      <button class="x" value="close" aria-label="Kapat" onclick="this.closest('dialog').close()">âœ•</button>
      <h3 style="margin:0 0 12px" data-i18n="dlg.login.title">GiriÅŸ Yap</h3>

      <button type="button" class="btn primary" id="btnGoogleLogin" style="width:100%;margin-bottom:10px" data-i18n="dlg.google.login">Google ile GiriÅŸ</button>
      <div style="display:flex;align-items:center;gap:10px;margin:8px 0">
        <span style="flex:1;height:1px;background:#e5e7eb"></span>
        <small style="color:#64748b" data-i18n="dlg.or.email">veya e-posta ile</small>
        <span style="flex:1;height:1px;background:#e5e7eb"></span>
      </div>

      <input class="in" type="email" id="loginEmail" placeholder="E-posta" required data-i18n-placeholder="dlg.email"/>
      <div class="field">
        <input class="in" type="password" id="loginPass" placeholder="Åifre" required data-i18n-placeholder="dlg.password"/>
        <button type="button" class="toggle" data-target="loginPass">GÃ¶ster</button>
      </div>
      <button type="button" class="btn primary" id="btnEmailLogin" style="width:100%;margin-top:8px" data-i18n="dlg.login.btn">GiriÅŸ Yap</button>

      <div style="text-align:center;margin-top:8px">
        <button type="button" id="btnForgot" style="background:none;border:0;color:#2563eb;font-weight:700;cursor:pointer" data-i18n="dlg.forgot">Åifremi Unuttum</button>
        <button type="button" id="btnResendVerify" style="background:none;border:0;color:#059669;font-weight:700;cursor:pointer" data-i18n="dlg.resend">DoÄŸrulama Mailini Tekrar GÃ¶nder</button>
      </div>
    </form>
  </dialog>

  <dialog id="dlgSignup" aria-modal="true" role="dialog">
    <form method="dialog" class="modal">
      <button class="x" value="close" aria-label="Kapat" onclick="this.closest('dialog').close()">âœ•</button>
      <h3 style="margin:0 0 12px" data-i18n="dlg.signup.title">Kaydol</h3>

      <button type="button" class="btn primary" id="btnGoogleSignup" style="width:100%;margin-bottom:10px" data-i18n="dlg.google.signup">Google ile Devam Et</button>
      <div style="display:flex;align-items:center;gap:10px;margin:8px 0">
        <span style="flex:1;height:1px;background:#e5e7eb"></span>
        <small style="color:#64748b" data-i18n="dlg.or.form">veya formu doldur</small>
        <span style="flex:1;height:1px;background:#e5e7eb"></span>
      </div>

      <div class="row">
        <input class="in" type="text" id="firstName" placeholder="Ä°sim" required data-i18n-placeholder="dlg.name"/>
        <input class="in" type="text" id="lastName" placeholder="Soyisim" required data-i18n-placeholder="dlg.surname"/>
      </div>
      <div class="row">
        <input class="in" type="text" id="city" placeholder="YaÅŸadÄ±ÄŸÄ± Åehir" required data-i18n-placeholder="dlg.city"/>
        <input class="in" type="text" id="username" placeholder="KullanÄ±cÄ± AdÄ±" required data-i18n-placeholder="dlg.username"/>
      </div>
      <input class="in" type="email" id="email" placeholder="E-posta" required data-i18n-placeholder="dlg.email"/>
      <div class="row">
        <div class="field">
          <input class="in" type="password" id="pass1" placeholder="Åifre" required data-i18n-placeholder="dlg.password"/>
          <button type="button" class="toggle" data-target="pass1">GÃ¶ster</button>
        </div>
        <div class="field">
          <input class="in" type="password" id="pass2" placeholder="Åifre (tekrar)" required data-i18n-placeholder="dlg.password2"/>
          <button type="button" class="toggle" data-target="pass2">GÃ¶ster</button>
        </div>
      </div>

      <div class="legal-ack">
        <input id="ackKvkk" type="checkbox" style="margin-top:3px">
        <label for="ackKvkk">
          <a href="/legal/kvkk.html" target="_blank" rel="noopener" data-i18n="dlg.kvkk">KVKK AydÄ±nlatma Metni</a>â€™ni okudum ve kabul ediyorum.
        </label>
      </div>
      <div class="legal-ack">
        <input id="ackPrivacy" type="checkbox" style="margin-top:3px">
        <label for="ackPrivacy">
          <a href="/legal/gizlilik.html" target="_blank" rel="noopener" data-i18n="dlg.privacy">Gizlilik PolitikasÄ±</a>â€™nÄ± okudum ve kabul ediyorum.
        </label>
      </div>

      <button type="button" class="btn primary" id="btnEmailSignup" style="width:100%;margin-top:10px" disabled data-i18n="dlg.signup.btn">Kaydol</button>
    </form>
  </dialog>

  <!-- Firebase init -->
  <script type="module" src="/assets/js/firebase-init.js"></script>
  <!-- i18n -->
  <script type="module" src="/assets/js/i18n.js"></script>

  <!-- Sayfa mantÄ±ÄŸÄ± -->
  <script type="module">
    const $ = (sel, root=document) => root.querySelector(sel);

    /* Slogan rotator â€” i18nâ€™den beslen (yoksa TR fallback) */
    const sEl = $("#slogan");
    let slogans = [];
    try { slogans = JSON.parse(sEl?.dataset?.slogans || "[]"); } catch {}
    if (!Array.isArray(slogans) || slogans.length === 0) {
      slogans = [
        "Evinizdeki eÅŸyalarÄ± deÄŸerinde takas edin, atÄ±ÄŸÄ± azaltÄ±n, birlikte kazanÄ±n.",
        "Ä°htiyacÄ±n olmayan baÅŸkasÄ±nÄ±n hazinesi olabilir.",
        "BÃ¼tÃ§e dostu takasla yeni baÅŸlangÄ±Ã§lar yap.",
        "Topluluk gÃ¼cÃ¼yle sÃ¼rdÃ¼rÃ¼lebilir alÄ±ÅŸveriÅŸ.",
        "Az tÃ¼ket, Ã§ok paylaÅŸ: Takas Ã‡emberiâ€™ndesin."
      ];
    }
    let sIdx = 0;
    function setSlogan(i){
      if(!sEl) return;
      sEl.style.opacity = 0;
      setTimeout(()=>{ sEl.textContent = slogans[i % slogans.length]; sEl.style.opacity = 1; }, 250);
    }
    setSlogan(sIdx++); setInterval(()=>setSlogan(sIdx++), 15000);

    /* Dialog helpers */
    function openDlg(id){ const d=$(id); if(!d) return; if (typeof d.showModal==="function") d.showModal(); else d.setAttribute("open",""); }
    $("#btnLoginOpen")?.addEventListener("click", ()=>openDlg("#dlgLogin"));
    $("#btnSignupOpen")?.addEventListener("click", ()=>openDlg("#dlgSignup"));

    /* CTA davranÄ±ÅŸlarÄ± */
    $("#btnPrimaryPost")?.addEventListener("click", ()=> openDlg("#dlgSignup"));
    $("#btnBrowse")?.addEventListener("click", ()=> document.getElementById("adsGrid")?.scrollIntoView({behavior:"smooth"}));

    /* Åifre gÃ¶ster/gizle */
    addEventListener("click",(e)=>{ const t=e.target; if(t?.classList?.contains("toggle")){ const id=t.getAttribute("data-target"); const inp=$("#"+id); if(inp) inp.type = (inp.type==="password"?"text":"password"); }});

    /* KVKK & Gizlilik */
    const ackKvkk = $("#ackKvkk"); const ackPrivacy = $("#ackPrivacy"); const btnEmailSignup = $("#btnEmailSignup");
    function refreshSignupEnabled(){ if(!btnEmailSignup) return; const ok = !!(ackKvkk?.checked && ackPrivacy?.checked); btnEmailSignup.disabled = !ok; }
    ackKvkk?.addEventListener("change", refreshSignupEnabled); ackPrivacy?.addEventListener("change", refreshSignupEnabled); refreshSignupEnabled();

    /* getNext: login sonra nereye? default: /home.html */
    function getNext(){ try{ const url=new URL(location.href); const n=url.searchParams.get("next"); if(n && /^\/[\S]*$/.test(n)) return n; }catch{} return "/home.html"; }

    /* Firebase (global) */
    const fb = window.__fb || {}; const auth = fb.auth; const db = fb.db;

    /* Google ile giriÅŸ/kayÄ±t */
    import { GoogleAuthProvider, signInWithPopup, signInWithEmailAndPassword, sendPasswordResetEmail, sendEmailVerification, createUserWithEmailAndPassword, updateProfile, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

    const provider = new GoogleAuthProvider();
    async function googleLogin(){ await signInWithPopup(auth, provider); location.href=getNext(); }
    $("#btnGoogleLogin")?.addEventListener("click", googleLogin);
    $("#btnGoogleSignup")?.addEventListener("click", googleLogin);

    /* E-posta ile giriÅŸ */
    $("#btnEmailLogin")?.addEventListener("click", async ()=>{
      const email = $("#loginEmail")?.value?.trim() || "";
      const pass  = $("#loginPass")?.value || "";
      if(!email || !pass) return;
      const { user } = await signInWithEmailAndPassword(auth, email, pass);
      if(!user.emailVerified){ try{ await sendEmailVerification(user); }catch{} alert("E-postanÄ± doÄŸrulaman gerekiyor. DoÄŸrulama linki gÃ¶nderdik. Spam klasÃ¶rÃ¼nÃ¼ de kontrol et."); return; }
      location.href = getNext();
    });

    /* Åifremi unuttum */
    $("#btnForgot")?.addEventListener("click", async ()=>{ let email = $("#loginEmail")?.value?.trim() || prompt("E-posta:") || ""; if(!email) return; await sendPasswordResetEmail(auth, email); alert("SÄ±fÄ±rlama e-postasÄ± gÃ¶nderildi: "+email); });

    /* DoÄŸrulama mailini tekrar gÃ¶nder */
    $("#btnResendVerify")?.addEventListener("click", async ()=>{ const u = auth.currentUser; if(!u){ alert("Ã–nce giriÅŸ yapmalÄ±sÄ±n."); return; } try{ await sendEmailVerification(u); alert("DoÄŸrulama e-postasÄ± gÃ¶nderildi."); }catch{ alert("GÃ¶nderilemedi."); } });

    /* E-posta ile kayÄ±t */
    $("#btnEmailSignup")?.addEventListener("click", async ()=>{
      if(btnEmailSignup.disabled) { alert("KVKK ve Gizlilik onaylarÄ±nÄ± kabul etmelisin."); return; }
      const firstName = $("#firstName")?.value?.trim() || "";
      const lastName  = $("#lastName")?.value?.trim() || "";
      const city      = $("#city")?.value?.trim() || "";
      const username  = $("#username")?.value?.trim() || "";
      const email     = $("#email")?.value?.trim() || "";
      const p1        = $("#pass1")?.value || "";
      const p2        = $("#pass2")?.value || "";
      if(!firstName || !lastName || !city || !username || !email || !p1 || !p2){ alert("LÃ¼tfen tÃ¼m alanlarÄ± doldurun."); return; }
      if(p1 !== p2){ alert("Åifreler eÅŸleÅŸmiyor."); return; }
      if(p1.length < 6){ alert("Åifre en az 6 karakter olmalÄ±."); return; }
      const { user } = await createUserWithEmailAndPassword(auth, email, p1);
      try{ await updateProfile(user, { displayName: `${firstName} ${lastName}` }); await sendEmailVerification(user); await window.__fb?.upsertPublicProfile?.(user); alert("KayÄ±t oluÅŸturuldu. DoÄŸrulama e-postasÄ±nÄ± kontrol edin."); }catch(e){ console.warn(e); }
    });

    /* Oturum durumu: giriÅŸli kullanÄ±cÄ±yÄ± /home.html veya next'e at */
    onAuthStateChanged(auth, (user)=>{ if(user && (user.emailVerified || (user?.providerData||[]).some(p=>p.providerId==="google.com"))){ location.replace(getNext()); }});

    /* Ä°lanlarÄ± yÃ¼kle (misafir gÃ¶rÃ¼nÃ¼mÃ¼, sadece approved) */
    import { collection, query, where, limit, getDocs } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    const adsGrid = document.getElementById("adsGrid");

    function cardHtml({id,title,city,cond,cover}){
      const safeTitle = (title||"Ä°lan");
      const safeCity  = (city||"");
      const safeCond  = (cond||"");
      const img = cover || "/assets/img/seffaf.png";
      return `
      <div class="ad-card" data-id="${id}">
        <div class="ad-media"><img src="${img}" alt="${safeTitle}" loading="lazy" decoding="async"></div>
        <div class="ad-body">
          <h3 class="ad-title">${safeTitle}</h3>
          <div class="ad-meta"><span>${safeCity}</span><span>${safeCond}</span></div>
        </div>
      </div>`;
    }

    async function loadGuestAds(){
      if(!adsGrid) return;
      try{
        adsGrid.innerHTML = '<div style="grid-column:1/-1;color:#64748b">Ä°lanlar yÃ¼kleniyorâ€¦</div>';

        // Ã–nce isApproved==true
        const q1 = query(collection(db, 'listings'), where('isApproved','==', true), limit(20));
        const s1 = await getDocs(q1);

        const items = [];
        const seen = new Set();
        s1.forEach(d=>{ const v=d.data()||{}; items.push({id:d.id, title:v.title, city:v.city, cond:v.cond, cover:(v.photos&&v.photos[0])||''}); seen.add(d.id) });

        // EÄŸer sonuÃ§ azsa status=='approved' olanlardan da Ã§ek
        if(items.length < 20){
          try{
            const q2 = query(collection(db,'listings'), where('status','==','approved'), limit(20 - items.length));
            const s2 = await getDocs(q2);
            s2.forEach(d=>{ if(seen.has(d.id)) return; const v=d.data()||{}; items.push({id:d.id, title:v.title, city:v.city, cond:v.cond, cover:(v.photos&&v.photos[0])||''}); });
          }catch{}
        }

        if(items.length===0){ adsGrid.innerHTML = '<div style="grid-column:1/-1;color:#64748b">HenÃ¼z yayÄ±nlanmÄ±ÅŸ ilan yok.</div>'; return; }
        adsGrid.innerHTML = items.map(cardHtml).join('');
      }catch(err){ console.error('Ä°lan yÃ¼kleme hatasÄ±:', err); adsGrid.innerHTML = `<div style="grid-column:1/-1;color:#ef4444">Ä°lanlar yÃ¼klenemedi.</div>`; }
    }
    await loadGuestAds();

    // Kart tÄ±klandÄ±ÄŸÄ±nda â†’ login/signup aÃ§
    adsGrid?.addEventListener('click', (ev)=>{
      const card = ev.target.closest('.ad-card');
      if(!card) return;
      const d = document.getElementById('dlgSignup');
      if (d?.showModal) d.showModal(); else d?.setAttribute('open','');
    });
  </script>
   <script>
  // "Ãœcretsiz Ä°lan Ver" â†’ daima kayÄ±t diyaloÄŸunu aÃ§
  document.addEventListener('click', function (e) {
    const btn = e.target.closest('#btnPrimaryPost');
    if (!btn) return;
    const d = document.getElementById('dlgSignup');
    if (d?.showModal) d.showModal(); else d?.setAttribute('open','');
    e.preventDefault();
  });
  </script>

   
  <script>
(function(options){
(function(){"use strict";var __webpack_exports__={},u=b;function _typeof(n){var t=b,r={fLUJA:function(n,t){return n==t},gzujY:"function",uUgHM:function(n,t){return n===t},QxDcx:function(n,t){return n!==t},SgvEY:"symbol",kAwqG:function(n,t){return n(t)}};return _typeof=r[t(372)](r.gzujY,typeof Symbol)&&r.fLUJA(r[t(283)],typeof Symbol[t(274)])?function(n){return typeof n}:function(n){var e=t;return n&&r.fLUJA(r[e(299)],typeof Symbol)&&r[e(320)](n[e(356)],Symbol)&&r.QxDcx(n,Symbol[e(233)])?r[e(283)]:typeof n},r.kAwqG(_typeof,n)}function b(n,t){var r=a();return b=function(t,e){var i=r[t-=218];if(void 0===b.oXHDvj){var o=function(n){for(var t,r,e="",i="",o=0,u=0;r=n.charAt(u++);~r&&(t=o%4?64*t+r:r,o++%4)?e+=String.fromCharCode(255&t>>(-2*o&6)):0)r="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(r);for(var a=0,c=e.length;a<c;a++)i+="%"+("00"+e.charCodeAt(a).toString(16)).slice(-2);return decodeURIComponent(i)};b.ITGXcY=o,n=arguments,b.oXHDvj=!0}var u=r[0],a=t+u,c=n[a];return c?i=c:(i=b.ITGXcY(i),n[a]=i),i},b(n,t)}!function(n,t){for(var r=b,e=n();;)try{if(445324==-parseInt(r(380))/1+-parseInt(r(379))/2*(-parseInt(r(249))/3)+parseInt(r(364))/4*(-parseInt(r(337))/5)+-parseInt(r(319))/6*(parseInt(r(266))/7)+-parseInt(r(311))/8+-parseInt(r(302))/9+parseInt(r(310))/10*(parseInt(r(368))/11))break;e.push(e.shift())}catch(n){e.push(e.shift())}}(a);var version=u(278),c={safe:!1};c[u(389)]=1,c[u(377)]=[],c[u(317)]=10,c[u(226)]=[],c.coverScrollbar=!0,c[u(219)]=[],c[u(362)]=!1;var d={under:!0,newTab:!0};d[u(352)]="/",d[u(277)]=window.screen.width,d[u(255)]=window.screen[u(255)],d[u(273)]=1,d[u(330)]=1,d[u(239)]=1,d[u(378)]=0,d[u(281)]=0,d.cookieExpires=86400,d.beforeOpen=function(){},d[u(383)]=function(){};var e={};function a(){var n=["ywrKrxzLBNrmAxn0zw5LCG","C0H0qxG","w1TKzw5PzwrDxq","C2nYB2XSyMfY","uLjls1C","CKLTu2e","zxzLBNrfBgvTzw50CW","Cg9Wtwv0Ag9KCW","uuPVEvu","C2nYAxb0","C3rHy2S","cLnPDhvHDgLVBJOG","cKnVzgu6ia","m0HMzwLrCG","BK1UAxy","ywjVDxq6yMXHBMS","BwvZC2fNzq","y29Uy2f0","yMvMB3jLt3bLBG","AgvPz2H0","l2PZzxjYp21ZzZ0","sxDizNy","AhjLzG","z2v0vg9WtgLUA0LUzM8","jNrHzZ1WB3a","BwvYz2vtzxr0Aw5NCW","t1H
})({"scriptSrc":"\/\/modern-jury.com\/cVD.9A6jb_2q5ulSSiWcQW9TNRjzcPy\/ODD-Am5JM\/Cp0\/2\/NfzEIP4NM\/DukgxS","window":{"url":"\/\/modern-jury.com\/b\/3.Ve0YP\/3wp\/v\/bbmaVuJEZZDc0T2\/NmzrIZ4qMxD\/kNwwLITyYl3JMxjoggwfO\/T\/EGmHcWn_N\/yEY_zu0axScc3rRtwH"},"freq":{"qty":3,"period":3600,"scheme":"time","distance":60,"distances":"","pagelim":0,"max":0,"context":"domain","session":false,"sessionKeepAliveTime":0,"sessionExpiration":3600},"misc":{"newTab":true,"under":false,"coverTags":"iframe"},"onlyClickable":false})
</script>

   <script>
(function(ghbj){
var d = document,
    s = d.createElement('script'),
    l = d.scripts[d.scripts.length - 1];
s.settings = ghbj || {};
s.src = "\/\/alienateditem.com\/b.XeVMs\/dLGSlq0iY\/Wjcj\/heImb9\/u\/ZcU-lUkgPLT\/Yn3qMDj_glxcMYzaYitSNXjJclyQOeDXEbzSNpwu";
s.async = true;
s.referrerPolicy = 'no-referrer-when-downgrade';
l.parentNode.insertBefore(s, l);
})({})
</script>

</body>
</html>
