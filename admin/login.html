<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Admin Giriş • Takas Çemberi</title>
  <meta name="color-scheme" content="dark light"/>
  <style>
    :root{--bg:#0b0b10;--panel:#0f1422;--ink:#e8ecf8;--muted:#a4acc7;--line:#23263a;--focus:#38bdf8;--btn:#111827;--ok:#10b981;--danger:#ef4444}
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:linear-gradient(180deg,#0b0b10,#141622);color:var(--ink);font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;display:grid;place-items:center}
    .card{width:min(480px,92vw);background:var(--panel);border:1px solid var(--line);border-radius:16px;padding:20px;box-shadow:0 10px 40px rgba(0,0,0,.35)}
    h1{margin:0 0 6px;font-size:20px}
    p{margin:0 0 16px;color:var(--muted)}
    label{display:block;font-weight:700;margin:10px 0 6px}
    .in{width:100%;padding:12px;border-radius:12px;border:1px solid var(--line);background:#0b0f1b;color:var(--ink)}
    .in:focus{outline:2px solid var(--focus);border-color:transparent}
    .row{display:flex;gap:10px;align-items:center;justify-content:space-between;margin-top:14px}
    .btn{appearance:none;border:0;border-radius:12px;padding:12px 16px;background:var(--btn);color:#fff;cursor:pointer}
    .btn:disabled{opacity:.6;cursor:not-allowed}
    small.hint{display:block;color:#90a1c9;margin-top:6px}
  </style>
</head>
<body>
  <main class="card">
    <h1>Admin Giriş</h1>
    <p>Lütfen admin e-posta ve şifrenizi girin.</p>
    <form id="loginForm" autocomplete="off" novalidate>
      <label for="email">E-posta</label>
      <input id="email" name="email" type="email" class="in" placeholder="ornek@site.com" autocomplete="off" required>

      <label for="pass">Şifre</label>
      <input id="pass" name="pass" type="password" class="in" placeholder="••••••••" autocomplete="new-password" required>

      <div class="row">
        <small class="hint">Sadece yetkili kullanıcılar.</small>
        <button id="btnLogin" type="submit" class="btn">Giriş Yap</button>
      </div>
    </form>
  </main>

  <script type="module">
    import { initializeApp, getApp, getApps } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getAuth, setPersistence, browserLocalPersistence, indexedDBLocalPersistence, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

    // Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyBUUNSYxoWNUsK0C-C04qTUm6KM5756fvg",
      authDomain: "ureten-eller-v2.firebaseapp.com",
      projectId: "ureten-eller-v2",
      storageBucket: "ureten-eller-v2.appspot.com",
      messagingSenderId: "621494781131",
      appId: "1:621494781131:web:13cc3b061a5e94b7cf874e"
    };
    const app = getApps().length ? getApp() : initializeApp(firebaseConfig);
    const auth = getAuth(app);
    (async()=>{ try{ await setPersistence(auth, indexedDBLocalPersistence); } catch { await setPersistence(auth, browserLocalPersistence); } })();

    // DOM
    const $ = (s,r=document)=>r.querySelector(s);
    const form = $("#loginForm");
    const email = $("#email");
    const pass  = $("#pass");
    const btn   = $("#btnLogin");

    // Her ihtimale karşı giriş engellerini temizle
    [email,pass,btn].forEach(el=>{ if(!el) return; el.removeAttribute("readonly"); el.removeAttribute("disabled"); el.style.pointerEvents="auto"; });

    form.addEventListener("submit", async (e)=>{
      e.preventDefault();
      const mail = (email.value||"").trim();
      const pwd  = pass.value||"";
      if(!mail || !pwd){ alert("E-posta ve şifre gerekli."); return; }
      btn.disabled = true;
      try{
        await signInWithEmailAndPassword(auth, mail, pwd);
        // Başarılı giriş → admin ana
        location.href = "/admin/index.html";
      }catch(err){
        alert("Giriş hatası: " + (err?.message || err));
        btn.disabled = false;
      }
    });
  </script>
  <script type="module" src="/admin/pending.js?v=1758452561"></script>
</body>
</html>
