<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Profil â€¢ Takas Ã‡emberi</title>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --txt:#0b1020; --muted:#2b3b62; --pri:#5b8aff;
      --ok:#16a34a; --warn:#f59e0b; --err:#ef4444; --stroke:rgba(0,0,0,.12);
      --g1:#ff7a7a; --g2:#ffd166; --g3:#6ee7ff; --g4:#9b8cff; --g5:#4ade80;
      --card:rgba(255,255,255,.86); --card2:rgba(255,255,255,.94);
      --mbnav-h:72px;

      /* 3D yÄ±ldÄ±z renkleri â€“ sadece kÄ±rmÄ±zÄ±/beyaz arasÄ±nda gider gelir (siyah yok) */
      --star-fill:#ffffff;
      --star-stroke:#ffffff;
      --star-glow:rgba(255,255,255,.9);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    html,body{overflow-x:hidden}
    body{
      margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;color:var(--txt);
      background:linear-gradient(120deg,var(--g1),var(--g2),var(--g3),var(--g4),var(--g5));
      background-size:300% 300%;animation:gradientShift 18s ease infinite;min-height:100vh
    }
    @keyframes gradientShift{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
    a{color:inherit;text-decoration:none}
    img{max-width:100%;display:block}

    .wrap{max-width:1100px;margin:0 auto;padding:16px;
      /* mobilde alt barÄ±n Ã¼stÃ¼ne dÃ¼ÅŸmesin diye fazladan boÅŸluk */
      padding-bottom:calc(var(--mbnav-h) + 56px + env(safe-area-inset-bottom,0px));
    }
    header.hd{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:10px 14px;margin-bottom:14px;position:sticky;top:0;background:rgba(255,255,255,.7);backdrop-filter:blur(8px);border:1px solid var(--stroke);border-radius:16px;z-index:50}
    .brand{display:flex;align-items:center;gap:10px}
    .brand img{height:38px;width:38px;border-radius:12px;border:1px solid var(--stroke)}
    .brand b{font-weight:800;letter-spacing:.3px}

    /* Ãœst menÃ¼ler */
    nav.desktop{display:none;gap:8px;align-items:center}
    nav.mobileTop{display:flex;gap:8px}
    .btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;border:1px solid var(--stroke);padding:10px 14px;border-radius:12px;background:var(--card);color:#0b1020;cursor:pointer}
    .btn.warn{background:transparent;border-color:var(--warn);color:#8a5400}

    /* GRID ve sÄ±ralama */
    .grid{display:grid;grid-template-columns:1fr;gap:16px}
    #secProfile{order:1}
    #secPassword{order:2}
    #secRating{order:3}
    #secListings{order:4}

    @media(min-width:880px){
      nav.desktop{display:flex}
      nav.mobileTop{display:none}
      .grid{
        grid-template-columns:1fr 1fr;
        grid-template-areas:
          "left right"
          "full1 full1"
          "full2 full2";
      }
      #secProfile{grid-area:left;order:0}
      #secPassword{grid-area:right;order:0}
      #secRating{grid-area:full1;order:1}  /* Puanlama ilanlarÄ±n Ã¼stÃ¼nde */
      #secListings{grid-area:full2;order:2}
    }

    .card{background:var(--card);border:1px solid var(--stroke);border-radius:18px;overflow:hidden;box-shadow:0 10px 30px rgba(0,0,0,.08)}
    .card .hd{padding:14px 16px;border-bottom:1px solid var(--stroke);font-weight:800;color:#0b1020;background:var(--card2)}
    .card .bd{padding:16px}

    .profileRow{display:grid;grid-template-columns:96px 1fr;gap:16px;align-items:center}
    .avatar{width:96px;height:96px;border-radius:18px;overflow:hidden;border:1px solid var(--stroke);background:linear-gradient(135deg,#ffffff,#f5f7ff);display:grid;place-items:center}
    .avatar img{width:100%;height:100%;object-fit:cover}
    .muted{color:var(--muted);font-size:.92rem}

    .fields{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .field{display:flex;flex-direction:column;gap:6px}
    .field label{font-size:.86rem;color:var(--muted)}
    .field input{width:100%;height:44px;background:#ffffff;border:1px solid var(--stroke);border-radius:12px;padding:0 12px;color:#0b1020}
    .field input[disabled]{opacity:.8}
    @media(max-width:879px){ .fields{grid-template-columns:1fr} } /* MOBÄ°L: kutucuklar tam geniÅŸlik; kayma yok */

    .pwgrid{display:grid;grid-template-columns:1fr;gap:10px}
    .pwgrid input{height:44px;background:#ffffff;border:1px solid var(--stroke);border-radius:12px;padding:0 12px;color:#0b1020}

    /* 3D YÄ±ldÄ±zlar */
    .stars{display:inline-flex;gap:8px;filter:drop-shadow(0 2px 2px rgba(0,0,0,.15)) drop-shadow(0 6px 12px rgba(239,68,68,.25))}
    .stars svg{width:28px;height:28px}
    .ownerStars{position:relative;padding:12px 14px;border-radius:12px;overflow:hidden;margin-bottom:8px}
    .ownerStars::before{content:"";position:absolute;inset:0;z-index:0;
      background:linear-gradient(120deg,#b91c1c,#ef4444,#ffffff,#ef4444,#b91c1c);
      background-size:300% 300%;
      animation:flagWave 4s ease-in-out infinite;
      filter:saturate(1.15) brightness(1.05);
    }
    .ownerStars .stars{position:relative;z-index:1}
    /* yÄ±ldÄ±zlarÄ±n rengi beyaz<->kÄ±rmÄ±zÄ± arasÄ± dÃ¶ner, siyah yok */
    @keyframes flagWave{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
    @keyframes starColorFlip{0%{--star-fill:#ffffff;--star-stroke:#ffffff;--star-glow:rgba(255,255,255,.95)}50%{--star-fill:#b91c1c;--star-stroke:#b91c1c;--star-glow:rgba(239,68,68,.9)}100%{--star-fill:#ffffff;--star-stroke:#ffffff;--star-glow:rgba(255,255,255,.95)}}
    .ownerStars .stars{animation:starColorFlip 4s ease-in-out infinite}

    /* Ä°LANLAR */
    .lists-triple{display:grid;gap:12px}
    .col{background:rgba(255,255,255,.88);border:1px solid var(--stroke);border-radius:14px;padding:12px}
    .col h3{margin:6px 0 10px}
    .listings{display:grid;grid-template-columns:1fr;gap:12px}
    .listing{border:1px solid var(--stroke);border-radius:12px;overflow:hidden;background:rgba(255,255,255,.98)}
    .listing .thumb{height:120px;background:#f3f6ff;display:grid;place-items:center}
    .listing .thumb img{width:100%;height:100%;object-fit:cover}
    .listing .meta{padding:10px 12px;display:grid;gap:6px}
    .badge{display:inline-flex;align-items:center;gap:6px;padding:4px 8px;border:1px solid var(--stroke);border-radius:999px;font-size:.8rem;color:#334155;background:#ffffff}
    .badge.ok{border-color:#1b5e32;color:#166534;background:#e8f9ef}
    .badge.warn{border-color:#6b4a0a;color:#92400e;background:#fff4e5}
    .badge.err{border-color:#5b1a1a;color:#7f1d1d;background:#ffecec}

    /* MOBÄ°L Ä°lan sekme butonlarÄ± */
    .mobile-tabs{display:flex;gap:8px;margin-bottom:10px}
    .pill{flex:1;display:inline-flex;align-items:center;justify-content:center;padding:10px;border-radius:999px;border:1px solid var(--stroke);background:#fff;color:#0b1020;cursor:pointer}
    .pill.active{background:#0b1020;color:#fff}
    @media(min-width:880px){
      .mobile-tabs{display:none}
      .lists-triple{grid-template-columns:repeat(3,1fr)}
      .lists-triple .col{display:block}
    }
    @media(max-width:879px){
      .lists-triple{grid-template-columns:1fr}
      .lists-triple .col{display:none}
      .lists-triple .col.show{display:block}
    }

    /* ALT BAR (mobil sabit) */
    .mbnav{position:fixed;bottom:0;left:0;right:0;height:var(--mbnav-h);display:grid;grid-template-columns:repeat(3,1fr);gap:6px;padding:8px;background:rgba(255,255,255,.94);backdrop-filter:blur(8px);border-top:1px solid var(--stroke);z-index:60}
    .mbnav a{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:4px;color:#0b1020}
    .mbnav a.active{border:1px solid var(--stroke);border-radius:8px}
    @media(min-width:880px){ .mbnav{display:none} }
  </style>
</head>
<body>
  <div class="wrap">
    <header class="hd">
      <div class="brand">
        <img src="./assets/img/seffaf.png" alt="Logo">
        <div>
          <b>Takas Ã‡emberi</b>
          <div class="muted" id="hdrSub">Profil</div>
        </div>
      </div>

      <!-- MasaÃ¼stÃ¼ Ã¼st menÃ¼: sadece 4 buton -->
      <nav class="desktop">
        <a class="btn" href="home.html">ğŸ  Sayfa</a>
        <a class="btn" href="messages.html">ğŸ’¬ Mesajlar</a>
        <a class="btn" href="notifications.html">ğŸ”” Bildirimler</a>
        <button class="btn warn" id="btnLogout">ğŸšª Ã‡Ä±kÄ±ÅŸ</button>
      </nav>

      <!-- Mobil Ã¼st: sadece Ã‡Ä±kÄ±ÅŸ -->
      <nav class="mobileTop">
        <button class="btn warn" id="btnLogoutTop">ğŸšª Ã‡Ä±kÄ±ÅŸ</button>
      </nav>
    </header>

    <div class="grid">
      <!-- Profil -->
      <section id="secProfile" class="card">
        <div class="hd">Profil</div>
        <div class="bd">
          <div class="profileRow">
            <div class="avatar"><img id="avatar" alt="Profil"></div>
            <div>
              <h2 id="displayName" style="margin:0;font-size:1.4rem">â€”</h2>
              <span class="badge" id="usernameBadge">@kullanici</span>

              <!-- ğŸ“· Resim ekleme/deÄŸiÅŸtirme butonu (username'in ALTINDA) -->
              <div class="row" style="margin-top:8px">
                <label class="btn" style="padding:8px 12px">
                  ğŸ“· Resim Ekle / DeÄŸiÅŸtir
                  <input type="file" id="fileAvatar" accept="image/*" style="display:none">
                </label>
              </div>

              <div class="muted" id="publicInfo">Ä°sim, soyisim, telefon ve e-posta gizlidir.</div>
            </div>
          </div>
          <div class="spacer"></div>
          <div class="fields">
            <div class="field"><label>Ä°sim</label><input id="inpFirst" disabled></div>
            <div class="field"><label>Soyisim</label><input id="inpLast" disabled></div>
            <div class="field"><label>KullanÄ±cÄ± AdÄ±</label><input id="inpUsername" disabled></div>
            <div class="field"><label>Telefon</label><input id="inpPhone" disabled></div>
            <div class="field"><label>E-posta</label><input id="inpEmail" disabled></div>
          </div>
        </div>
      </section>

      <!-- Åifre (mobilde profilin altÄ±nda) -->
      <section id="secPassword" class="card">
        <div class="hd">Åifre DeÄŸiÅŸtir</div>
        <div class="bd">
          <div class="pwgrid">
            <input type="password" id="pwOld" placeholder="Mevcut ÅŸifre">
            <input type="password" id="pwNew" placeholder="Yeni ÅŸifre">
            <input type="password" id="pwNew2" placeholder="Yeni ÅŸifre (tekrar)">
            <button class="btn pri" id="btnPw">DeÄŸiÅŸikliÄŸi Onayla</button>
            <div class="muted">â€¢ Eski ÅŸifre sorulur. â€¢ Yeni ÅŸifre iki kez girilir.</div>
          </div>
        </div>
      </section>

      <!-- Puanlama (MasaÃ¼stÃ¼nde ilanlarÄ±n Ã¼stÃ¼nde) -->
      <section id="secRating" class="card">
        <div class="hd">Puanlama</div>
        <div class="bd">
          <!-- KÄ±rmÄ±zÄ±-beyaz dalgalÄ± arka plan + 3D 5 sabit yÄ±ldÄ±z -->
          <div id="ownerStarsWrap" class="ownerStars">
            <div class="stars" id="ownerStars">
              <!-- 3D STAR (inline SVG) x5 -->
              <svg viewBox="0 0 24 24" aria-hidden="true"><defs>
                <linearGradient id="g1" x1="0" y1="0" x2="0" y2="1">
                  <stop offset="0%" stop-color="var(--star-fill)"/>
                  <stop offset="55%" stop-color="var(--star-fill)"/>
                  <stop offset="56%" stop-color="rgba(255,255,255,.6)"/>
                  <stop offset="100%" stop-color="var(--star-fill)"/>
                </linearGradient>
              </defs>
              <path d="M12 2.5l2.6 5.3 5.9.86-4.25 4.14 1 5.86L12 16.9 6.75 18.7l1-5.86L3.5 8.66l5.9-.86L12 2.5z"
                fill="url(#g1)" stroke="var(--star-stroke)" stroke-width="0.6"
                style="filter:drop-shadow(0 2px 2px var(--star-glow)) drop-shadow(0 6px 12px rgba(239,68,68,.28))"/>
              </svg>
              <svg viewBox="0 0 24 24" aria-hidden="true"><use href="#"/></svg>
              <svg viewBox="0 0 24 24" aria-hidden="true"><use href="#"/></svg>
              <svg viewBox="0 0 24 24" aria-hidden="true"><use href="#"/></svg>
              <svg viewBox="0 0 24 24" aria-hidden="true"><use href="#"/></svg>
            </div>
          </div>

          <div class="stars readonly" id="avgStars">
            <!-- ortalama gÃ¶sterimi iÃ§in boÅŸ 5 yÄ±ldÄ±z (grey deÄŸil; saydam Ã§izgi) -->
            <svg viewBox="0 0 24 24"><path d="M12 2.5l2.6 5.3 5.9.86-4.25 4.14 1 5.86L12 16.9 6.75 18.7l1-5.86L3.5 8.66l5.9-.86L12 2.5z" fill="none" stroke="#b91c1c" stroke-width="1"/></svg>
            <svg viewBox="0 0 24 24"><path d="M12 2.5l2.6 5.3 5.9.86-4.25 4.14 1 5.86L12 16.9 6.75 18.7l1-5.86L3.5 8.66l5.9-.86L12 2.5z" fill="none" stroke="#b91c1c" stroke-width="1"/></svg>
            <svg viewBox="0 0 24 24"><path d="M12 2.5l2.6 5.3 5.9.86-4.25 4.14 1 5.86L12 16.9 6.75 18.7l1-5.86L3.5 8.66l5.9-.86L12 2.5z" fill="none" stroke="#b91c1c" stroke-width="1"/></svg>
            <svg viewBox="0 0 24 24"><path d="M12 2.5l2.6 5.3 5.9.86-4.25 4.14 1 5.86L12 16.9 6.75 18.7l1-5.86L3.5 8.66l5.9-.86L12 2.5z" fill="none" stroke="#b91c1c" stroke-width="1"/></svg>
            <svg viewBox="0 0 24 24"><path d="M12 2.5l2.6 5.3 5.9.86-4.25 4.14 1 5.86L12 16.9 6.75 18.7l1-5.86L3.5 8.66l5.9-.86L12 2.5z" fill="none" stroke="#b91c1c" stroke-width="1"/></svg>
          </div>
          <div class="muted" id="avgText">0/5 â€¢ 0 oy</div>

          <!-- ZiyaretÃ§i iÃ§in oy verme alanÄ± (isteÄŸe baÄŸlÄ±) -->
          <div id="rateBox" style="display:none;margin-top:8px">
            <div class="muted">Bu kullanÄ±cÄ±yÄ± puanla (1-5)</div>
            <div class="stars" id="rateStars"></div>
          </div>
        </div>
      </section>

      <!-- Ä°lanlar -->
      <section id="secListings" class="card">
        <div class="hd">Ä°lanlar</div>
        <div class="bd">
          <!-- MOBÄ°L: 3 kategori BUTON -->
          <div class="mobile-tabs">
            <button class="pill active" data-target="colActive">YayÄ±ndakiler</button>
            <button class="pill" data-target="colPending">Onay Bekleyenler</button>
            <button class="pill" data-target="colExpired">SÃ¼resi Dolanlar</button>
          </div>

          <!-- MasaÃ¼stÃ¼: 3 sÃ¼tun | Mobil: yalnÄ±z seÃ§ilen gÃ¶sterilir -->
          <div class="lists-triple">
            <div class="col show" id="colActive">
              <h3>YayÄ±ndakiler</h3>
              <div class="listings" id="listActive"></div>
            </div>
            <div class="col" id="colPending">
              <h3>Onay Bekleyenler</h3>
              <div class="listings" id="listPending"></div>
            </div>
            <div class="col" id="colExpired">
              <h3>SÃ¼resi Dolanlar</h3>
              <div class="listings" id="listExpired"></div>
            </div>
          </div>
        </div>
      </section>
    </div>
  </div>

  <!-- MOBÄ°L alt bar: sabit (3 ikon) -->
  <nav class="mbnav">
    <a href="home.html" class="active">ğŸ <small>Ana Sayfa</small></a>
    <a href="messages.html">ğŸ’¬<small>Mesajlar</small></a>
    <a href="notifications.html">ğŸ””<small>Bildirimler</small></a>
  </nav>

  <script>
    // --- YardÄ±mcÄ±lar ---
    const $ = s => document.querySelector(s);
    const $$ = s => Array.from(document.querySelectorAll(s));
    const qp = new URLSearchParams(location.search);
    const get = k => qp.get(k);

    // KullanÄ±cÄ± bilgilerini query'den al (yoksa Ã¶rnekler)
    const user = {
      firstName: get('first') || 'Ali',
      lastName:  get('last')  || 'YÄ±lmaz',
      username:  get('username') || 'kullanici',
      phone:     get('phone') || 'Gizli',
      email:     get('email') || 'Gizli',
    };

    // Profil doldur
    $('#displayName').textContent = `${user.firstName} ${user.lastName}`.trim();
    $('#usernameBadge').textContent = '@' + user.username;
    $('#inpFirst').value = user.firstName;
    $('#inpLast').value  = user.lastName;
    $('#inpUsername').value = user.username;
    $('#inpPhone').value = user.phone;
    $('#inpEmail').value = user.email;

    // Avatar (localStorage)
    const AVATAR_KEY = 'tc_profile_avatar';
    const avatar = $('#avatar');
    const saved = localStorage.getItem(AVATAR_KEY);
    avatar.src = saved || 'https://dummyimage.com/300x300/ffffff/000&text=ğŸ‘¤';

    $('#fileAvatar')?.addEventListener('change', async (e)=>{
      const f = e.target.files && e.target.files[0];
      if(!f) return;
      const reader = new FileReader();
      reader.onload = () => {
        const data = reader.result;
        avatar.src = data;
        try { localStorage.setItem(AVATAR_KEY, data); } catch(e) { console.log('LocalStorage dolu olabilir:', e); }
      };
      reader.readAsDataURL(f);
    });

    // Ã‡Ä±kÄ±ÅŸ butonlarÄ± (dummy yÃ¶nlendirme)
    $('#btnLogout')?.addEventListener('click', ()=> location.href='auth.html');
    $('#btnLogoutTop')?.addEventListener('click', ()=> location.href='auth.html');

    // Mobil ilan sekmeleri
    (function(){
      const pills = $$('.mobile-tabs .pill');
      const cols = {
        colActive: $('#colActive'),
        colPending: $('#colPending'),
        colExpired: $('#colExpired'),
      };
      pills.forEach(btn=>{
        btn.addEventListener('click', ()=>{
          pills.forEach(b=>b.classList.remove('active'));
          btn.classList.add('active');
          const t = btn.dataset.target;
          Object.keys(cols).forEach(k => cols[k].classList.toggle('show', k===t));
          // Alt barda ezilmesin: aktif sÃ¼tunun altÄ±na boÅŸluk
          cols[t].style.marginBottom = '16px';
        });
      });
    })();

    // Ortalama yÄ±ldÄ±zlarÄ± (gÃ¶rsel amaÃ§lÄ±) doldur/boÅŸalt Ã¶rneÄŸi
    function setAvgStars(val){ /* val: 0..5 */ 
      const stars = $('#avgStars').querySelectorAll('path');
      stars.forEach((p,i)=> p.setAttribute('fill', i<val ? '#b91c1c' : 'none'));
    }
    setAvgStars(0); // 0/5 baÅŸlangÄ±Ã§

  </script>
</body>
</html>
